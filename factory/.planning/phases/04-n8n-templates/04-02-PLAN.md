---
phase: 04-n8n-templates
plan: 02
type: execute
---

<objective>
Create data webhook template and comprehensive README with placeholder reference and import guide.

Purpose: Complete the n8n template collection with the non-AI data lookup pattern, and provide documentation so any developer can import and configure templates for a new bot project.
Output: bot-data-webhook.json template + n8n-templates/README.md with full placeholder reference and import instructions
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@factory/README.md
@factory/n8n-templates/bot-chat-orchestrator.json
@factory/n8n-templates/bot-tool-webhook.json
</context>

<safety>
Same read-only n8n policy as 04-01:
- ONLY mcp__n8n__n8n_get_workflow (GET) — no create/update/delete
- All output is local files in factory/n8n-templates/
- Templates ship with "active": false
</safety>

<tasks>

<task type="auto">
  <name>Task 1: Export and parameterize bot-data-webhook.json</name>
  <files>factory/n8n-templates/bot-data-webhook.json</files>
  <action>
  1. Use ToolSearch to load n8n MCP tools, then call mcp__n8n__n8n_get_workflow with ID "orPmNC8zgtOENjUe" (BizBot v4 License Finder — the only pure data webhook, no AI involved).

  2. Save the raw JSON, then apply parameterization:

  **Top-level fields:**
  - "name" → "{{BOT_NAME}} - {{DATA_ENDPOINT_NAME}}"
  - "active" → false
  - Remove "id", "versionId", "meta", "pinData", "staticData"

  **Webhook node:**
  - parameters.path → "{{BOT_SLUG}}-{{DATA_SLUG}}"
  - webhookId → "{{BOT_SLUG}}-{{DATA_SLUG}}-webhook"
  - allowedOrigins (if present) → "{{CORS_ORIGINS}}" (default: "*")

  **Credential references:**
  - Postgres credentials → { "id": "{{CREDENTIAL_POSTGRES}}", "name": "Postgres account" }
  - (No OpenAI/Anthropic needed — this is a pure DB query pattern)

  **Database query nodes:**
  - Table names in SQL → "{{DB_SCHEMA}}.{{DATA_TABLE}}" and "{{DB_SCHEMA}}.{{DATA_TABLE_SECONDARY}}" (if joins present)
  - Replace BizBot-specific column names with generic comments explaining the pattern:
    - The query structure (JOIN, WHERE, etc.) should remain as an example
    - Add a comment in the Code node: "// CUSTOMIZE: Replace table names, column names, and query logic for your domain"

  **Business logic Code nodes:**
  - Replace BizBot-specific license/permit logic with a skeleton structure:
    - Keep the input validation pattern (check required fields, return 400)
    - Keep the response envelope pattern ({ success, data, summary })
    - Replace the actual business logic body with placeholder comments explaining what goes there
  - This is intentionally MORE of a skeleton than the other two templates because data webhooks are domain-specific by nature

  **Response node:**
  - Keep CORS headers (Access-Control-Allow-Origin, etc.)
  - Keep the error response pattern

  3. Validate JSON syntax.

  AVOID: Do NOT try to make this template generic enough to "just work" — data webhooks are inherently custom. The value is the structural pattern (webhook → validate → query → process → respond), not pre-built logic. Make it a clear skeleton, not a half-working abstraction.
  </action>
  <verify>
  - File exists at factory/n8n-templates/bot-data-webhook.json
  - JSON is valid
  - No real credential IDs remain
  - No BizBot-specific table names: grep for "license_requirements", "license_agencies" should return nothing
  - No real webhook paths: grep for "bizbot-license-finder" should return nothing
  - NO AI/LLM nodes: grep for "lmChat" and "embeddingsOpenAi" should return nothing
  - Placeholders present: grep for "{{DATA_TABLE}}" should return matches
  - "active" is false
  </verify>
  <done>
  - bot-data-webhook.json exists with valid JSON
  - Contains ~7 nodes (webhook, validate, IF, query, process, respond-success, respond-error)
  - No AI/LLM/embedding nodes — pure data pipeline
  - BizBot business logic replaced with skeleton + comments
  - All hardcoded values replaced with {{PLACEHOLDER}} tokens
  - "active": false
  </done>
</task>

<task type="auto">
  <name>Task 2: Create n8n-templates README with placeholder reference and import guide</name>
  <files>factory/n8n-templates/README.md</files>
  <action>
  Create a comprehensive README.md covering:

  **1. Overview section:**
  - What the 3 templates are and when to use each
  - Quick comparison table: template name | use case | has AI | has memory | node count

  **2. Template descriptions:**
  For each template (chat-orchestrator, tool-webhook, data-webhook):
  - Purpose and typical use case
  - Node pipeline diagram (text-based: Webhook → Parse → ... → Respond)
  - Production example it was derived from

  **3. Complete placeholder reference table:**
  Consolidate ALL {{PLACEHOLDER}} tokens across all 3 templates into a single reference table:
  - Placeholder name | Description | Default value | Which templates use it | Example value
  - Group by category: Identity, Credentials, LLM Config, RAG Config, Content, Data-specific
  - Every placeholder must appear in this table — scan all 3 JSON files to build the complete list

  **4. Import instructions:**
  Step-by-step guide:
  1. Open n8n (https://n8n.vanderdev.net)
  2. Create new workflow
  3. Use menu → Import from File → select template JSON
  4. Find-and-replace placeholders (list the critical ones that MUST be replaced before activating)
  5. Set up credentials (link to n8n credential docs pattern)
  6. Test with curl example
  7. Activate workflow

  **5. Placeholder replacement script:**
  Include a small bash script section (inline in README, not a separate file) showing how to do batch replacement:
  ```bash
  # Example: Replace all placeholders for a new "AgBot" project
  sed -e 's/{{BOT_NAME}}/AgBot/g' \
      -e 's/{{BOT_SLUG}}/agbot/g' \
      -e 's/{{DB_SCHEMA}}/agbot/g' \
      ... bot-chat-orchestrator.json > agbot-chat.json
  ```

  **6. Credential setup notes:**
  - Which credentials each template needs (OpenAI, Anthropic, Postgres)
  - How to find credential IDs in n8n (Settings → Credentials → click credential → ID in URL)
  - Reminder: credential IDs are instance-specific, must be replaced on every import

  **7. Customization guide:**
  - How to modify the system prompt for a new domain
  - How to add/remove RAG category filters
  - How to adjust similarity thresholds and top-K
  - How to add decision tree tool webhooks for a new bot

  Use markdown formatting consistent with factory/README.md style. No emojis.
  </action>
  <verify>
  - File exists at factory/n8n-templates/README.md
  - Contains all 7 sections listed above
  - Placeholder table accounts for EVERY {{PLACEHOLDER}} in all 3 JSON files (cross-reference with grep)
  - Import instructions reference the correct n8n URL (n8n.vanderdev.net)
  - sed example is syntactically valid
  - No broken markdown (headers, tables, code blocks all properly formatted)
  </verify>
  <done>
  - README.md exists with all 7 sections
  - Placeholder reference table is complete (every token from all 3 templates listed)
  - Import guide is step-by-step and actionable
  - sed replacement example covers the most common placeholders
  - Documentation is sufficient for a developer to import and configure templates without prior n8n experience
  </done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] All 3 template JSON files exist in factory/n8n-templates/ (chat-orchestrator from 04-01 + tool-webhook from 04-01 + data-webhook from this plan)
- [ ] README.md exists with complete placeholder reference
- [ ] Every {{PLACEHOLDER}} across all 3 JSON files appears in the README table
- [ ] All 3 templates have "active": false
- [ ] Zero real credentials or bot-specific paths in any file
- [ ] README import instructions are accurate and complete
</verification>

<success_criteria>

- 3rd template (data webhook) created, completing the template collection
- README provides complete self-service documentation
- Placeholder reference table is exhaustive — no undocumented tokens
- A developer can import and configure a template following only the README
- Phase 4 deliverables complete: 3 templates + README
</success_criteria>

<output>
After completion, create `.planning/phases/04-n8n-templates/04-02-SUMMARY.md` following the summary template.

This is the final plan in Phase 4. After the summary, update:
- STATE.md: Phase 4 complete, position updated
- ROADMAP.md: Phase 4 checked off
</output>
