---
phase: 07-factory-orchestrator
plan: 02
type: execute
---

<objective>
Validate the complete factory pipeline end-to-end with dry-run checks, then finalize all project documentation to close out the factory build.

Purpose: Prove every factory component works (scripts parse, templates exist, skills load, JSON validates) and leave the project in a clean, documented, complete state.
Output: Verified pipeline, updated README.md, completed PROJECT.md, final STATE.md.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Prior plan in this phase:
@.planning/phases/07-factory-orchestrator/07-01-SUMMARY.md

# Key files to validate:
@~/.claude/commands/gov-factory/SKILL.md
@factory/factory/README.md
@factory/factory/DEPLOY-CHECKLIST.md
@factory/factory/MEMORY-SCHEMA.md

**Tech stack available:** All factory scripts, skills, templates from Phases 1-6 + orchestrator from 07-01
**Established patterns:** --dry-run safety, --help usage, shellcheck, YAML frontmatter, JSON schema validation
**Constraining decisions:**
- Phase 6: All deploy scripts support --dry-run and --help flags
- Phase 2: scaffold.sh supports --help
- Phase 1: chunk-knowledge.js uses --input/--output flags
</context>

<tasks>

<task type="auto">
  <name>Task 1: Dry-run validation of full pipeline</name>
  <files>No files created — validation only</files>
  <action>
Run systematic checks across every factory component to verify the pipeline is intact. This is a verification-only task — fix any issues found inline.

**A. Script validation (7 scripts):**
```bash
# Each script should respond to --help without error
bash factory/factory/scripts/scaffold.sh --help
bash factory/factory/scripts/setup-supabase-schema.sh --help
bash factory/factory/scripts/deploy-bot.sh --help
bash factory/factory/scripts/deploy-form.sh --help
node factory/factory/scripts/chunk-knowledge.js --help
python3 factory/factory/scripts/embed-chunks.py --help
python3 factory/factory/scripts/validate-knowledge.py --help
```

If any Python scripts fail due to missing imports (psycopg2, openai), that's expected — verify they at least parse:
```bash
python3 -c "import ast; ast.parse(open('factory/factory/scripts/embed-chunks.py').read())"
python3 -c "import ast; ast.parse(open('factory/factory/scripts/validate-knowledge.py').read())"
```

**B. Template validation (10+ templates):**
Verify every template file referenced in SKILL.md exists:
```bash
ls factory/factory/templates/knowledge/TEMPLATE.md
ls factory/factory/templates/knowledge/decision-tree-schema.json
ls factory/factory/templates/decks/stakeholder-brief.md
ls factory/factory/templates/decks/developer-assessment.md
ls factory/factory/templates/decks/stakeholder-deck.md
ls factory/factory/templates/decks/technical-deck.md
ls factory/factory/templates/bot-CLAUDE.md.template
ls factory/factory/templates/form-CLAUDE.md.template
ls factory/factory/templates/gsd/bot-ROADMAP.md
ls factory/factory/templates/gsd/form-ROADMAP.md
ls factory/factory/templates/bot/PageComponent.jsx.template
ls factory/factory/templates/bot/DecisionTree.json.template
```

**C. n8n template validation (3 JSON files):**
```bash
# Verify valid JSON
node -e "JSON.parse(require('fs').readFileSync('factory/factory/n8n-templates/bot-chat-orchestrator.json', 'utf8')); console.log('OK')"
node -e "JSON.parse(require('fs').readFileSync('factory/factory/n8n-templates/bot-tool-webhook.json', 'utf8')); console.log('OK')"
node -e "JSON.parse(require('fs').readFileSync('factory/factory/n8n-templates/bot-data-webhook.json', 'utf8')); console.log('OK')"
```

**D. Skill file validation (5 skills):**
```bash
# Verify all skill files exist and have YAML frontmatter
for skill in SKILL.md build-decks.md new-project.md research-domain.md research-to-knowledge.md status.md; do
  ls ~/.claude/commands/gov-factory/$skill
done
```

Check each skill has `---` YAML frontmatter block with `name:` field (except SKILL.md which is an index).

**E. Decision tree JSON schema validation:**
```bash
# Verify schema is valid JSON Schema
node -e "const s = JSON.parse(require('fs').readFileSync('factory/factory/templates/knowledge/decision-tree-schema.json', 'utf8')); console.log(s['$schema'] || 'No schema ref'); console.log('OK')"
```

**F. Cross-reference check:**
Verify the SKILL.md References Index lists every file found in steps A-E. If any file is missing from the index, note it for Task 2.

If any validation fails, fix the issue immediately before moving to the next check. Report a summary of all checks passed/fixed at the end.
  </action>
  <verify>All 7 scripts respond to --help or parse cleanly, all 12+ template files exist, all 3 n8n JSONs parse, all 5+1 skill files exist with frontmatter, JSON schema validates</verify>
  <done>Every factory component verified: 7 scripts, 12+ templates, 3 n8n workflows, 6 skill files. Zero broken references.</done>
</task>

<task type="auto">
  <name>Task 2: Final documentation pass</name>
  <files>factory/factory/README.md, .planning/PROJECT.md, .planning/STATE.md, .planning/ROADMAP.md</files>
  <action>
Close out the factory project with final documentation updates.

**A. factory/factory/README.md updates:**
- Update Quick Start section: replace `[Phase 7]` placeholder with actual `/gov-factory:new-project` usage and example invocation
- Add `/gov-factory:status` to the Quick Start as step 3 (check project status)
- Add MEMORY-SCHEMA.md to the directory layout
- Update version line at bottom from "Phase 1: Foundation" to "v1.0 — All phases complete"
- Verify all script entries in the Scripts table are current (should include all 7 scripts)

**B. .planning/PROJECT.md updates:**
- Move all Active requirements to Validated (mark with [x]) — every requirement from Phases 1-7 has been built
- Update Key Decisions table: change all "Pending" outcomes to "Shipped" with brief evidence
- Update "Last updated" line

**C. .planning/STATE.md updates:**
- Set Phase: 7 of 7 (Factory Orchestrator)
- Set Plan: 2 of 2 in current phase
- Set Status: Project complete
- Set Progress: ████████████████████ 100%
- Add 07-01 and 07-02 to Performance Metrics table
- Update Session Continuity to reflect project completion

**D. .planning/ROADMAP.md updates:**
- Check Phase 7 plans as complete: `[x] 07-01` and `[x] 07-02`
- Update Progress table: Phase 7 status to "Complete" with today's date
- Mark Phase 7 checkbox as `[x]` in the phase list

Do NOT touch files or sections that are already correct. Only update stale placeholders and incomplete markers.
  </action>
  <verify>README Quick Start shows /gov-factory:new-project usage (no [Phase 7] placeholder). PROJECT.md has all requirements marked [x]. STATE.md shows 100% progress. ROADMAP.md shows all 7 phases complete.</verify>
  <done>All documentation finalized. Factory project marked complete across README, PROJECT, STATE, and ROADMAP.</done>
</task>

</tasks>

<verification>
Before declaring phase complete:
- [ ] All 7 scripts pass --help or parse validation
- [ ] All template files exist on disk
- [ ] All n8n JSON files parse without error
- [ ] All 6 skill files present in ~/.claude/commands/gov-factory/
- [ ] README.md Quick Start has real /gov-factory:new-project usage
- [ ] PROJECT.md requirements all marked [x] Validated
- [ ] STATE.md shows 100% complete
- [ ] ROADMAP.md shows all phases [x] complete
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- No broken references between SKILL.md and actual files
- Project documentation reflects completion state
- Phase 7 complete — factory is ready for first real project
</success_criteria>

<output>
After completion, create `.planning/phases/07-factory-orchestrator/07-02-SUMMARY.md`:

# Phase 7 Plan 2: End-to-End Smoke Test + Final Documentation Summary

**[Substantive one-liner]**

## Accomplishments

- [Validation results summary]
- [Documentation updates summary]

## Files Created/Modified

- [List]

## Decisions Made

[None expected]

## Issues Encountered

[Any validation failures and how they were fixed]

## Next Step

Phase 7 complete. Factory ready for first project: `/gov-factory:new-project "domain description" --track bot`
</output>
