---
phase: 03-tool-rebuilds
plan: 02
type: execute
---

<objective>
Add county-aware R&R agency lookup to both tools and connect all modes with cross-tool CTAs.

Purpose: Users currently get generic "contact your local R&R" advice. County-specific contacts make the bot actionable. Cross-tool CTAs prevent dead-end user experiences.
Output: County R&R JSON data + CountyRRLookup component + cross-tool navigation buttons + verified production build.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Prior plan in this phase:
@.planning/phases/03-tool-rebuilds/03-01-SUMMARY.md

# Data source for county R&R:
# ~/Documents/GitHub/CA-AIDev/kiddobot/ChildCareAssessment/07_County_Deep_Dives/All_58_Counties_RR_Directory.md

# Key files (on VPS — read via SSH):
# /root/vanderdev-website/src/components/kiddobot/EligibilityCalculator.jsx — refactored in 03-01
# /root/vanderdev-website/src/pages/KiddoBot.jsx — main page with mode routing
# /root/vanderdev-website/src/data/kiddobot-thresholds.json — created in 03-01
# /root/vanderdev-website/src/data/kiddobot-program-tree.json — ProgramFinder tree

**Production-first:** All file operations via `ssh vps "..."`. Dev repo is read-only (except reading source data from knowledge dir).

**Constraining decisions:**
- Shared DecisionTreeView.jsx must NOT be modified — it's used by all 3 bots
- County data comes from `All_58_Counties_RR_Directory.md` in local dev repo (read-only)
- KiddoBot accent color is pink/orange (orange for interactive elements, pink for bot identity)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create county R&R data file and CountyRRLookup component</name>
  <files>
/root/vanderdev-website/src/data/kiddobot-county-rr.json,
/root/vanderdev-website/src/components/kiddobot/CountyRRLookup.jsx
  </files>
  <action>
**Part A: Create `kiddobot-county-rr.json`**

Parse `~/Documents/GitHub/CA-AIDev/kiddobot/ChildCareAssessment/07_County_Deep_Dives/All_58_Counties_RR_Directory.md` (read locally) and create a JSON file on VPS.

Structure — object keyed by county name:
```json
{
  "Alameda": {
    "population": "1.7 million",
    "type": "Urban",
    "primaryRR": "4Cs of Alameda County",
    "phone": "(510) 582-2182",
    "website": "https://www.4calameda.org",
    "secondaryRR": "BANANAS Inc. - (510) 658-7353",
    "notes": "Multiple R&R options. Good coverage across urban and suburban areas."
  },
  ...
}
```

Extract ALL 58 counties. Include `primaryRR`, `phone`, `website` for every county. Include `secondaryRR` only when listed. Include `notes` with the practical guidance text. Include `type` (Urban/Rural/Very Rural/Suburban).

Write the JSON to VPS via SSH.

**Part B: Create `CountyRRLookup.jsx`**

A small, self-contained component on VPS that:
1. Imports county data from `../../data/kiddobot-county-rr.json`
2. Accepts props: `county` (string, optional — pre-selected county), `accentColor` (string)
3. If `county` is provided and matches a key, displays the R&R info card immediately
4. If no county or no match, shows a county dropdown to select
5. Renders a card with: agency name, phone (clickable tel: link), website (clickable), notes, and secondary R&R if available
6. Styled consistently with the existing dark theme (bg-neutral-800/50, border-neutral-700, text classes matching ProgramCard.jsx)
7. Import icons from `../Icons` — use `Phone`, `Globe`, `MapPin` (or closest available — check what Icons exports)

Keep it simple: ~80-100 lines. No complex state. Just a lookup display.
  </action>
  <verify>
ssh vps "cat /root/vanderdev-website/src/data/kiddobot-county-rr.json | python3 -c 'import json,sys; d=json.load(sys.stdin); print(\"Counties:\", len(d)); print(\"Alameda:\", d.get(\"Alameda\",{}).get(\"primaryRR\")); print(\"Alpine:\", d.get(\"Alpine\",{}).get(\"primaryRR\"))'"
— should show 58 counties, Alameda = "4Cs of Alameda County", Alpine = "Catalyst Community"

ssh vps "test -f /root/vanderdev-website/src/components/kiddobot/CountyRRLookup.jsx && echo EXISTS"
  </verify>
  <done>58-county JSON file and CountyRRLookup component both exist on VPS. JSON has all required fields for every county.</done>
</task>

<task type="auto">
  <name>Task 2: Wire county R&R into tools + add cross-tool CTAs + verify build</name>
  <files>
/root/vanderdev-website/src/components/kiddobot/EligibilityCalculator.jsx,
/root/vanderdev-website/src/pages/KiddoBot.jsx
  </files>
  <action>
**Part A: County R&R in EligibilityCalculator results**

In EligibilityCalculator.jsx, after the results are shown:
1. Import `CountyRRLookup` from `./CountyRRLookup`
2. In the results section, REPLACE the generic disclaimer text ("Contact your local Resource & Referral (R&R) agency or visit rrnetwork.org") with the `<CountyRRLookup county={results.county} accentColor="orange" />` component
3. Keep the rrnetwork.org fallback link below the component as a secondary option

**Part B: County R&R in ProgramFinder**

In KiddoBot.jsx, in the `mode === 'programs'` block:
1. Import `CountyRRLookup` from `../components/kiddobot/CountyRRLookup`
2. Wrap the DecisionTreeView in a div
3. Below the DecisionTreeView, add a collapsible "Find Your Local R&R Agency" section with `<CountyRRLookup accentColor="orange" />` (no pre-selected county — user picks)
4. Style the wrapper so the R&R section appears below the tree results with some spacing

**Part C: Cross-tool CTAs**

Add navigation buttons that connect the tools:

1. **EligibilityCalculator results** → Add two CTA buttons after the "Calculate Again" button:
   - "Find Programs →" button that calls `onBack()` then triggers program finder mode
   - "Ask KiddoBot →" button that calls the existing `onLearnMore` with a contextual question

   To support "Find Programs", add a new prop `onFindPrograms` to EligibilityCalculator. In KiddoBot.jsx where EligibilityCalculator is rendered, pass `onFindPrograms={() => setMode('programs')}`.

2. **ProgramFinder wrapper** → After the DecisionTreeView and CountyRRLookup, add:
   - "Check Your Eligibility →" button that calls `setMode('calculator')`
   - "Ask KiddoBot →" button that calls `setMode('chat')` then `initializeChat()`

   Style these as secondary buttons (border border-neutral-700, not filled) to not compete with the tree's own navigation.

**Part D: Build verification**

Run `ssh vps "cd /root/vanderdev-website && npm run build"` and verify success.

Do NOT modify DecisionTreeView.jsx or any shared bot components.
  </action>
  <verify>
ssh vps "cd /root/vanderdev-website && npm run build 2>&1 | tail -5" — must succeed.

ssh vps "grep -c 'CountyRRLookup' /root/vanderdev-website/src/components/kiddobot/EligibilityCalculator.jsx" — should be >= 1.

ssh vps "grep -c 'CountyRRLookup' /root/vanderdev-website/src/pages/KiddoBot.jsx" — should be >= 1.

ssh vps "grep -c 'onFindPrograms' /root/vanderdev-website/src/pages/KiddoBot.jsx" — should be >= 1.
  </verify>
  <done>County R&R displays in both Calculator and ProgramFinder. Cross-tool CTAs link calculator ↔ programs ↔ chat. Production build succeeds on VPS. Phase 3 complete.</done>
</task>

</tasks>

<verification>
Before declaring phase complete:
- [ ] `ssh vps "cd /root/vanderdev-website && npm run build"` succeeds
- [ ] County R&R JSON has all 58 counties with agency, phone, website
- [ ] CountyRRLookup component renders in both Calculator results and ProgramFinder
- [ ] Cross-tool CTAs exist: Calculator → Programs, Calculator → Chat, Programs → Calculator, Programs → Chat
- [ ] No modifications to shared components (DecisionTreeView.jsx, ChatMessage.jsx)
- [ ] No console errors in browser (check after deploy in Phase 6)
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- County-specific R&R info displayed when county selected
- Cross-tool navigation flows work bidirectionally
- Production build succeeds
- Phase 3: Tool Rebuilds complete
</success_criteria>

<output>
After completion, create `.planning/phases/03-tool-rebuilds/03-02-SUMMARY.md`
</output>
