---
phase: 02-content-overhaul
plan: 03
type: execute
---

<objective>
Rewrite conservation, advocacy, operator guide, and regional board content with inline URLs and "Take Action" sections — the specialized audience group serving water operators, community advocates, and residents by region.

Purpose: These topics serve distinct audiences (operators need compliance guidance, advocates need data access, residents need regional contact info). The "Take Action" sections here are particularly important because each audience has different next steps.
Output: 8 updated JSON files (4 batch + 4 individual) with inline URLs, fact-checked content, and "Take Action" sections.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/phase-prompt.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Prior plans in this phase:
@.planning/phases/02-content-overhaul/02-01-SUMMARY.md
@.planning/phases/02-content-overhaul/02-02-SUMMARY.md

# URL registry:
@rag-content/waterbot/url_registry.json

# Files to rewrite (batch):
@rag-content/waterbot/batch_conservation.json
@rag-content/waterbot/batch_advocate_toolkit.json
@rag-content/waterbot/batch_operator_guides.json
@rag-content/waterbot/batch_regional_boards.json

# Files to update (individual):
@rag-content/waterbot/regional_board_directory.json
@rag-content/waterbot/regional_board_programs.json
@rag-content/waterbot/contact_regional_board.json
@rag-content/waterbot/annual_reporting.json

**Established patterns from 02-01/02-02:**
- Inline URLs as markdown hyperlinks (2-5 per doc)
- "## Take Action" section with 3-5 numbered steps + linked URLs
- URL type guides step wording
- Metadata preserved unchanged
- No bare URLs
- Content enhanced, not rewritten from scratch

**Special notes for this plan:**
- batch_conservation.json (8 docs, 32K chars) and batch_advocate_toolkit.json (8 docs, 30K chars) have the LONGEST content — these are deep, well-written docs. Enhancement should be surgical (add URLs, add "Take Action") not extensive rewriting.
- batch_advocate_toolkit.json already has 2 docs with URLs — verify these match registry and are in markdown link format.
- batch_regional_boards.json topics reference specific regional board jurisdictions — use region-specific URLs from registry.
</context>

<tasks>

<task type="auto">
  <name>Task 1: Rewrite 4 batch files — conservation, advocacy, operators, regional boards (31 docs)</name>
  <files>rag-content/waterbot/batch_conservation.json, rag-content/waterbot/batch_advocate_toolkit.json, rag-content/waterbot/batch_operator_guides.json, rag-content/waterbot/batch_regional_boards.json</files>
  <action>
  Load url_registry.json and process each batch file:

  1. For each document, match `metadata.topic` to registry entry
  2. Enhance content with inline markdown URLs
  3. Add `## Take Action` section with audience-appropriate steps
  4. Fact-check regulations, reporting requirements, conservation targets

  **For conservation topics** (8 docs, ~4K chars each — already detailed):
  - These docs are substantial. Add URLs surgically — don't restructure.
  - Inline links to DWR conservation programs, SWRCB water conservation pages
  - "Take Action" should guide: find local programs → implement conservation → track savings

  **For advocate toolkit topics** (8 docs, ~3.7K chars each):
  - 2 docs already have some URLs — verify they match registry, convert bare URLs to markdown
  - Inline links to CIWQS database, public records portals, meeting calendars
  - "Take Action" should guide: research violations → attend board meetings → file complaints

  **For operator guide topics** (5 docs, ~4.8K chars each):
  - Inline links to DDW operator certification, SWRCB compliance tools, reporting portals
  - "Take Action" should guide: check certification status → file reports → access training

  **For regional board topics** (10 docs, ~960 chars each — shorter):
  - Use REGION-SPECIFIC URLs from registry (each regional board has its own portal)
  - Inline links to specific board homepages and program pages
  - "Take Action" should guide: find your board → check programs → attend meetings → file complaints

  Write updated JSON back to same file paths.
  </action>
  <verify>
  Python verification:
  ```python
  import json
  for f in ['batch_conservation.json', 'batch_advocate_toolkit.json', 'batch_operator_guides.json', 'batch_regional_boards.json']:
      data = json.load(open(f'rag-content/waterbot/{f}'))
      docs = data if isinstance(data, list) else data.get('documents', [])
      for d in docs:
          assert 'http' in d['content'], f"Missing URLs: {d['metadata']['topic']}"
          assert '## Take Action' in d['content'], f"Missing Take Action: {d['metadata']['topic']}"
      print(f'{f}: {len(docs)} docs OK')
  ```
  </verify>
  <done>All 31 docs across 4 batch files contain inline URLs and "Take Action" sections. Existing URLs in advocate toolkit verified against registry.</done>
</task>

<task type="auto">
  <name>Task 2: Update 4 individual files and verify all 8 files</name>
  <files>rag-content/waterbot/regional_board_directory.json, rag-content/waterbot/regional_board_programs.json, rag-content/waterbot/contact_regional_board.json, rag-content/waterbot/annual_reporting.json</files>
  <action>
  These 4 individual files already have URLs. For each:

  1. Compare content URLs against registry — add missing URLs as inline links
  2. Convert bare URLs to markdown link format
  3. Add `## Take Action` section if not present
  4. Verify regional board contact info and program descriptions are current
  5. Write updated JSON back

  Then verify ALL 8 files in this plan:
  - Every doc has ≥2 inline markdown URLs
  - Every doc has "## Take Action" section
  - Regional board URLs are region-specific (not generic statewide links)
  - JSON valid
  - Total: 35 topics across 8 files
  </action>
  <verify>
  Comprehensive Python check:
  ```python
  import json, re
  files = [
      'batch_conservation.json', 'batch_advocate_toolkit.json',
      'batch_operator_guides.json', 'batch_regional_boards.json',
      'regional_board_directory.json', 'regional_board_programs.json',
      'contact_regional_board.json', 'annual_reporting.json'
  ]
  total = 0
  for f in files:
      data = json.load(open(f'rag-content/waterbot/{f}'))
      docs = data if isinstance(data, list) else data.get('documents', [])
      for d in docs:
          links = re.findall(r'\[([^\]]+)\]\(https?://[^)]+\)', d['content'])
          assert len(links) >= 2, f"Only {len(links)} links in {d['metadata']['topic']}"
          assert '## Take Action' in d['content'], f"Missing Take Action: {d['metadata']['topic']}"
          total += 1
  print(f'All {total} topics verified')
  ```
  </verify>
  <done>All 35 topics across 8 files have ≥2 inline markdown URLs and "Take Action" sections. Regional board URLs are region-specific.</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] All 4 batch files rewritten with inline URLs and "Take Action" sections
- [ ] All 4 individual files updated with consistent format
- [ ] Every doc has ≥2 inline markdown links
- [ ] Every doc has "## Take Action" with audience-appropriate steps
- [ ] Regional board topics use region-specific URLs (not generic statewide)
- [ ] Existing URLs in advocate toolkit verified against registry
- [ ] Metadata unchanged in all files
- [ ] JSON valid for all 8 files
</verification>

<success_criteria>

- All 35 topics enhanced with inline URLs and "Take Action" sections
- Audience-appropriate "Take Action" steps (operators vs advocates vs residents)
- Regional board URLs are region-specific
- All verification checks pass
</success_criteria>

<output>
After completion, create `.planning/phases/02-content-overhaul/02-03-SUMMARY.md`
</output>
