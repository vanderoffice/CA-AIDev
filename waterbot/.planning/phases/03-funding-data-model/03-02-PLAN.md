---
phase: 03-funding-data-model
plan: 02
type: execute
---

<objective>
Verify every program in `funding-programs.json` against current CA.gov and federal sources, fill eligibility gaps, fix stale data, and validate the complete data model is ready for Phase 4's matching algorithm.

Purpose: Ensure funding program data is accurate and current — users making eligibility decisions need trustworthy information, not stale or incomplete data.
Output: Verified `public/funding-programs.json` with all eligibility fields populated, URLs confirmed, and a verification log documenting sources checked.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-funding-data-model/03-01-SUMMARY.md

# The data model to verify:
@public/funding-programs.json

# RAG content for cross-reference:
@rag-content/waterbot/safer_eligibility.json
@rag-content/waterbot/safer_funding_amounts.json
@rag-content/waterbot/dwsrf_guide.json
@rag-content/waterbot/cwsrf_guide.json
@rag-content/waterbot/dac_grants.json
@rag-content/waterbot/small_community_funding.json

**Constraining decisions:**
- [03-01]: Schema is finalized — do not change field names or structure, only populate/correct values
- [PROJECT]: "All program details must be verified against current CA.gov/federal sources before shipping"
- [PROJECT]: Funding data accuracy is a stated constraint

**Research topics from roadmap:**
- Current CA SWRCB/DFA program details
- DWSRF/CWSRF current terms
- SAFER program status
- Prop 1 funding availability
- Federal EPA/USDA/FEMA current eligibility criteria
- DAC designation thresholds
</context>

<tasks>

<task type="auto">
  <name>Task 1: Verify state programs against CA.gov sources</name>
  <files>public/funding-programs.json</files>
  <action>
For every program with category "state-srf" or "state-grant", verify against current CA.gov sources:

**Primary verification sources:**
- SWRCB Financial Assistance: https://www.waterboards.ca.gov/water_issues/programs/grants_loans/
- FAAST portal: https://faast.waterboards.ca.gov/
- SAFER program: https://www.waterboards.ca.gov/drinking_water/certlic/drinkingwater/safer.html
- DWSRF: https://www.waterboards.ca.gov/drinking_water/services/funding/SRF.html
- CWSRF: https://www.waterboards.ca.gov/water_issues/programs/grants_loans/srf/

**For each state program, verify and fill:**
1. `fundingRange` — current funding amounts/caps
2. `interestRate` — current rates (these change annually)
3. `eligibility.entityTypes` — confirm who can apply
4. `eligibility.projectTypes` — confirm eligible project types
5. `eligibility.matchPercentage` — current local match requirements
6. `principalForgiveness` — current availability and conditions
7. `applicationUrl` — confirm FAAST link is correct
8. `programUrl` — confirm program page is live (not 404)

**Fill null fields** where verification finds data that the knowledge base didn't include.
**Correct stale data** where current terms differ from knowledge base (especially interest rates and funding amounts which change annually).
**Do NOT remove programs** — if a program appears closed/suspended, add a `"status": "suspended"` field and note in description. Do NOT delete from the array.

Log each program checked and what changed in a comment block or verification notes for the summary.
  </action>
  <verify>node -e "const d = require('./public/funding-programs.json'); const state = d.programs.filter(p => p.category.startsWith('state')); const nullFunding = state.filter(p => !p.fundingRange || (!p.fundingRange.min && !p.fundingRange.max && !p.fundingRange.notes)); console.log('State programs:', state.length); console.log('Still missing funding info:', nullFunding.length); const nullUrl = state.filter(p => !p.programUrl); console.log('Missing programUrl:', nullUrl.length)"</verify>
  <done>All state-srf and state-grant programs have verified funding ranges, current interest rates, confirmed eligibility criteria, and working URLs. Null eligibility fields reduced to minimum (only where information genuinely unavailable from current sources).</done>
</task>

<task type="auto">
  <name>Task 2: Verify federal programs and fill remaining gaps</name>
  <files>public/funding-programs.json</files>
  <action>
For every program with category "federal", verify against current federal sources:

**Primary verification sources:**
- EPA Water Finance: https://www.epa.gov/waterfinancecenter
- WIFIA: https://www.epa.gov/wifia
- USDA Rural Development: https://www.rd.usda.gov/programs-services/water-environmental-programs
- FEMA Hazard Mitigation: https://www.fema.gov/grants/mitigation
- Bureau of Reclamation WaterSMART: https://www.usbr.gov/watersmart/

**For each federal program, verify and fill** the same fields as Task 1.

**Then sweep ALL categories** (including private and technical-assistance):
1. Validate every `relatedPrograms` reference — each ID must exist in the programs array
2. Remove any relatedPrograms entries that point to nonexistent IDs
3. Check for programs that should be related but aren't linked (e.g., DWSRF ↔ SAFER, Prop 1 ↔ IRWM)
4. Ensure `tags` are consistent — use these canonical tags: `drinking-water`, `wastewater`, `stormwater`, `recycling`, `small-community`, `dac`, `emergency`, `planning`, `consolidation`, `infrastructure`, `operations`, `environmental`, `tribal`
5. Verify `metadata.totalPrograms` matches actual array length
6. Sort programs array by category then by name for consistent ordering

**Final validation:** Every program should have at minimum: id, name, category, description, fundingType, eligibility (with at least entityTypes and projectTypes populated), and ragQuery. Programs with all-null eligibility fields should be investigated — either fill from sources or flag in description why criteria are unavailable.
  </action>
  <verify>node -e "const d = require('./public/funding-programs.json'); console.log('Total programs:', d.programs.length, '(metadata says:', d.metadata.totalPrograms, ')'); const allIds = d.programs.map(p=>p.id); const badRefs = []; d.programs.forEach(p => { (p.relatedPrograms||[]).forEach(r => { if (!allIds.includes(r)) badRefs.push(p.id + ' -> ' + r) }) }); console.log('Bad relatedPrograms refs:', badRefs.length ? badRefs : 'none'); const weak = d.programs.filter(p => !p.eligibility || (!p.eligibility.entityTypes?.length && !p.eligibility.projectTypes?.length)); console.log('Programs with empty eligibility:', weak.map(p=>p.id)); const sorted = d.programs.every((p,i,a) => i===0 || (a[i-1].category + a[i-1].name) <= (p.category + p.name)); console.log('Sorted by category+name:', sorted)"</verify>
  <done>All federal programs verified against current sources. All relatedPrograms references valid. Tags normalized to canonical set. Programs sorted. metadata.totalPrograms accurate. Phase 3 data model complete and ready for Phase 4 matching algorithm.</done>
</task>

</tasks>

<verification>
Before declaring phase complete:
- [ ] `node -e "JSON.parse(require('fs').readFileSync('public/funding-programs.json'))"` — still valid JSON after edits
- [ ] No programs with completely empty eligibility objects
- [ ] All relatedPrograms references point to existing program IDs
- [ ] All programUrl and applicationUrl values return 2xx (spot-check top 10)
- [ ] metadata.totalPrograms matches array length
- [ ] Programs sorted consistently
- [ ] State programs have current interest rates and funding ranges
- [ ] No duplicate IDs
</verification>

<success_criteria>

- All state programs verified against CA.gov sources
- All federal programs verified against federal sources
- Null eligibility fields reduced to minimum
- All URLs confirmed working
- relatedPrograms cross-references validated
- Tags normalized to canonical set
- Data model ready for Phase 4 consumption
- Phase 3 complete
</success_criteria>

<output>
After completion, create `.planning/phases/03-funding-data-model/03-02-SUMMARY.md`

Phase 3 complete — funding-programs.json verified and ready for Phase 4 (Funding Navigator).
</output>
