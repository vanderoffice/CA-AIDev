---
phase: 05-integration-polish
plan: 02
type: execute
---

<objective>
Polish responsive layout, theme consistency, and accessibility across all three modes, then verify end-to-end flows.

Purpose: Ensure WaterBot looks and works correctly on mobile devices, maintains consistent dark theme styling, and meets basic accessibility standards before declaring v2.0 complete.
Output: Mobile-responsive layouts, consistent theme tokens, keyboard-accessible interactions, verified end-to-end flows.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Auto-selected based on dependency graph:
@.planning/phases/05-integration-polish/05-01-SUMMARY.md
@.planning/phases/01-shared-infrastructure/01-02-SUMMARY.md

# Key files:
@src/pages/WaterBot.jsx
@src/components/PermitFinder.jsx
@src/components/FundingNavigator.jsx
@src/components/ResultCard.jsx
@src/components/WizardStepper.jsx
@src/components/BotHeader.jsx
@src/components/AskWaterBot.jsx
@src/index.css
@tailwind.config.js

**Tech stack available:** React 18 + Vite + Tailwind CSS
**Established patterns:** dark theme (bg-neutral-900/800, text-white/neutral-400, border-neutral-800/700), glow-box/glow-text custom CSS, Inter/JetBrains Mono fonts

**Constraining decisions:**
- [01-02]: ResultCard uses `grid-cols-2` for details — needs stack on mobile
- [01-01]: WizardStepper has both dynamic and fixed modes
- [04-01]: Multi-select checkbox cards need touch-friendly sizing
</context>

<tasks>

<task type="auto">
  <name>Task 1: Mobile responsive fixes</name>
  <files>src/components/ResultCard.jsx, src/components/WizardStepper.jsx, src/pages/WaterBot.jsx, src/components/PermitFinder.jsx, src/components/FundingNavigator.jsx</files>
  <action>
    Audit and fix responsive issues at mobile breakpoints (375px–768px):

    1. **ResultCard.jsx**: Change details grid from `grid-cols-2` to `grid-cols-1 sm:grid-cols-2` so detail fields stack on mobile.

    2. **WizardStepper.jsx**: Ensure step counter and nav buttons don't overlap on narrow screens. Add `text-sm` responsive sizing if the title text is too large on mobile. Verify back/restart buttons have adequate touch targets (min 44x44px — add `min-h-[44px] min-w-[44px]` if needed).

    3. **WaterBot.jsx (landing page)**: The mode selection cards use `gap-4` — verify they render properly at 375px. The welcome box flex layout should wrap on very narrow screens: change the flex container from `flex items-start gap-4` to `flex flex-col sm:flex-row items-start gap-4` so the icon stacks above text on mobile.

    4. **WaterBot.jsx (chat)**: The input area flex layout (`flex gap-3`) works but the send button may be too small for touch. Ensure the send button has `min-w-[44px]` for touch accessibility.

    5. **PermitFinder.jsx / FundingNavigator.jsx**: Option buttons have `p-4` which is good for touch. Verify the results scrollable area has proper padding on mobile (it uses `px-4` in FundingNavigator — confirm PermitFinder result view also has consistent padding).

    Do NOT add media queries — use Tailwind responsive prefixes (`sm:`, `md:`) only.
  </action>
  <verify>
    - `npm run build` passes
    - In dev mode with Chrome DevTools responsive mode at 375px width: landing page cards readable, welcome box stacks icon above text, chat send button is tappable, ResultCard details stack vertically, wizard buttons don't overlap
  </verify>
  <done>All components render cleanly at 375px without overflow, overlapping elements, or untappable buttons</done>
</task>

<task type="auto">
  <name>Task 2: Theme consistency and accessibility</name>
  <files>src/components/ResultCard.jsx, src/components/AskWaterBot.jsx, src/components/WizardStepper.jsx, src/pages/WaterBot.jsx, src/index.css</files>
  <action>
    1. **Focus states**: Add `focus-visible:ring-2 focus-visible:ring-sky-500 focus-visible:ring-offset-2 focus-visible:ring-offset-neutral-900` to all interactive buttons that don't already have focus styles:
       - Mode selection buttons in WaterBot.jsx landing page
       - Option buttons in PermitFinder/FundingNavigator (the `bg-slate-800 hover:bg-slate-700` buttons)
       - AskWaterBot button
       - Chat suggested question buttons
       - The send button in chat
       Use `focus-visible:` (NOT `focus:`) to avoid styling on mouse clicks.
       Add `outline-none` alongside focus-visible ring classes to replace browser default focus outline.

    2. **ARIA labels**: Add `aria-label` to icon-only buttons:
       - Send button in chat: `aria-label="Send message"`
       - Back button in BotHeader (if it's icon-only): `aria-label="Go back"`
       - Restart button in WizardStepper: `aria-label="Restart"`

    3. **Color token consistency**: Scan for any raw hex colors in JSX (not index.css — those are intentional custom properties). All component styles should use Tailwind color tokens (neutral-*, slate-*, sky-*, cyan-*, etc.), not raw hex values. Fix any found.

    4. **Scrollbar styling**: The custom scrollbar in index.css only targets `-webkit-scrollbar`. Add `scrollbar-color: #333 #0a0a0a;` and `scrollbar-width: thin;` to `:root` for Firefox support.
  </action>
  <verify>
    - `npm run build` passes
    - Tab through the app — all interactive elements show visible focus rings
    - Inspect buttons — icon-only buttons have aria-labels
    - No raw hex colors in JSX files (check with grep)
  </verify>
  <done>All buttons have focus-visible styles; icon-only buttons have aria-labels; consistent color tokens; Firefox scrollbar styled</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Complete WaterBot v2.0 with cross-tool linking, responsive layout, and accessibility polish</what-built>
  <how-to-verify>
    1. Run: `npm run dev` in the waterbot directory
    2. Desktop (>1024px):
       - Landing page: All 3 mode cards display correctly with arrows
       - Chat: Send a message, verify response renders with markdown
       - Permit Finder: Navigate to any result → verify "Explore Funding" CTA appears → click it → lands on Funding Navigator
       - Funding Navigator: Complete questionnaire → verify results with related programs → verify "Find Permits" CTA → click it → lands on Permit Finder
    3. Mobile (375px in Chrome DevTools):
       - Landing page: Welcome box icon stacks above text, mode cards readable
       - Chat: Input and send button visible and tappable
       - Permit Finder: Options tappable, results don't overflow
       - Funding Navigator: Checkbox cards tappable, results don't overflow
       - ResultCard: Details stack to single column
    4. Keyboard:
       - Tab through landing page → all buttons show sky-blue focus ring
       - Tab into Permit Finder → option buttons focusable
       - Tab in chat → suggested questions and send button all focusable
    5. Verify: No console errors in any mode
  </how-to-verify>
  <resume-signal>Type "approved" to mark Phase 5 complete, or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring phase complete:
- [ ] `npm run build` succeeds without errors
- [ ] All three modes work end-to-end (chat, permits, funding)
- [ ] Cross-tool CTAs navigate correctly between tools
- [ ] Related programs display on funding result cards
- [ ] Mobile layout renders correctly at 375px
- [ ] Keyboard navigation works with visible focus indicators
- [ ] No console errors or warnings
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- Human approval of end-to-end flows on desktop and mobile
- No errors or warnings introduced
- Phase 5 complete — WaterBot v2.0 ready
</success_criteria>

<output>
After completion, create `.planning/phases/05-integration-polish/05-02-SUMMARY.md`:

# Phase 5 Plan 2: Responsive QA & Theme Polish Summary

**[Substantive one-liner]**

## Accomplishments
## Files Created/Modified
## Decisions Made
## Issues Encountered
## Next Phase Readiness
- Phase 5 complete — WaterBot v2.0 shipped
- All roadmap phases delivered
</output>
