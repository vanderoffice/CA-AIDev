---
phase: 08-rag-pipeline-improvements
plan: 02
type: execute
---

<objective>
Expand the LicenseFinder city dropdown to include unincorporated communities (Census Designated Places) for all 58 California counties, so users in unincorporated areas can accurately identify their location.

Purpose: Users in unincorporated CDPs (East Los Angeles, Arden-Arcade, Hacienda Heights, etc.) currently have no way to select their community. Since unincorporated areas fall under county jurisdiction — not city — this distinction affects which business licenses the Finder returns.
Output: Updated CA_CITIES object in LicenseFinder.jsx with unincorporated CDPs added alongside incorporated cities, deployed to production.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Prior phase summaries:
@.planning/phases/03-tool-rebuilds/03-01-SUMMARY.md
@.planning/phases/07-license-data-expansion/07-02-SUMMARY.md

**Current state:**
- CA_CITIES object in LicenseFinder.jsx maps 58 counties → 482 incorporated cities
- No unincorporated communities included
- Step 4 (Location) renders county dropdown → then city dropdown from CA_CITIES[county]
- City value is sent to n8n webhook as `city` field for license matching
- 25 cities have seeded license data (07-02); remainder get generic fallback

**Production file:** `/root/vanderdev-website/src/components/bizbot/LicenseFinder.jsx`

**Constraining decisions:**
- Production-first: edit on VPS via SSH
- city_biz_lic_ prefix convention for seeded city license codes
- hasCityLicense check in n8n prevents generic license pollution when real city data exists
- Santa Clarita → LA County TTC mapping (no own business license)

**Key considerations:**
- Unincorporated CDPs use COUNTY licensing, not city licensing
- The n8n webhook already handles unknown cities by falling back to county/generic licenses
- Adding `(Unincorporated)` suffix helps the UI distinguish from incorporated cities
- Focus on CDPs with population >1,000 to keep dropdown manageable
- Some counties (Alpine, Mariposa, Trinity) have few/no incorporated cities — CDPs are the ONLY option for residents
</context>

<tasks>

<task type="auto">
  <name>Task 1: Research California CDPs by county</name>
  <files>BizBot_v4/data/california_cdps.json (new, dev repo documentation)</files>
  <action>
Build a comprehensive list of California Census Designated Places (CDPs) organized by county.

Data sources — use US Census Bureau CDP listings for California:
- WebSearch for "California Census Designated Places by county" or "US Census Bureau CDP list California"
- Cross-reference with Wikipedia's "List of census-designated places in California" which is organized by county

Inclusion criteria:
- All CDPs with population ≥1,000 (per 2020 Census)
- For counties with zero or few incorporated cities (Alpine, Mariposa, Trinity, Sierra, Modoc, Mono, Inyo), include ALL CDPs regardless of population — these residents need SOME option
- Exclude CDPs that share exact names with incorporated cities in the SAME county (avoid confusion)

Output a JSON file mapping county → [cdp_names] for documentation. This is a reference artifact, not consumed by the app.

Target: ~300-500 CDPs across all 58 counties. LA County alone has ~80+ CDPs.
  </action>
  <verify>Validate JSON is well-formed. Spot-check 5 counties against Census data (LA, Sacramento, San Bernardino, Orange, Riverside). Confirm no duplicate entries with existing CA_CITIES incorporated cities within same county.</verify>
  <done>JSON reference file created with CDPs organized by county, population threshold applied, no duplicates with incorporated cities</done>
</task>

<task type="auto">
  <name>Task 2: Update CA_CITIES in LicenseFinder.jsx on production</name>
  <files>/root/vanderdev-website/src/components/bizbot/LicenseFinder.jsx</files>
  <action>
Edit the CA_CITIES object on VPS via SSH to add unincorporated CDPs:

1. For each county, append CDPs to the existing incorporated city array
2. Suffix each CDP with ` (Unincorporated)` — e.g., `"East Los Angeles (Unincorporated)"`
3. Sort the combined array alphabetically so incorporated and unincorporated are interleaved naturally
4. Keep existing incorporated city names EXACTLY as they are (no suffix, no changes)

Example for Alameda County:
```javascript
"Alameda": ["Alameda", "Albany", "Ashland (Unincorporated)", "Berkeley", "Castro Valley (Unincorporated)", "Cherryland (Unincorporated)", "Dublin", ...]
```

Important constraints:
- Do NOT modify the CA_COUNTIES array (stays at 58)
- Do NOT modify any other code in the file — only the CA_CITIES object
- The `(Unincorporated)` suffix is cosmetic for the dropdown — the n8n webhook receives the full string including suffix, and its existing fallback logic handles unknown city names correctly (falls back to county licenses)
- Build after editing: `cd /root/vanderdev-website && npm run build`
  </action>
  <verify>
ssh vps 'cd /root/vanderdev-website && npm run build' — build must succeed with no errors

Spot-check expanded arrays:
ssh vps 'grep -o "Unincorporated" /root/vanderdev-website/src/components/bizbot/LicenseFinder.jsx | wc -l' — should be >200

Verify LA County has major CDPs:
ssh vps 'grep "East Los Angeles" /root/vanderdev-website/src/components/bizbot/LicenseFinder.jsx' — should match
  </verify>
  <done>CA_CITIES updated with unincorporated CDPs on production, build succeeds, dropdown includes both incorporated cities and CDPs with clear labeling</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] Build succeeds on VPS (`npm run build`)
- [ ] CA_CITIES contains both incorporated cities and CDPs
- [ ] CDPs are suffixed with `(Unincorporated)` for clear distinction
- [ ] Counties with no incorporated cities (Alpine, Mariposa, Trinity) now have selectable options
- [ ] No changes to CA_COUNTIES array or other component code
- [ ] Spot-check 5 major counties for completeness
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- Build succeeds cleanly
- CA_CITIES expanded from ~482 to ~782+ entries (482 incorporated + 300+ CDPs)
- Existing License Finder functionality unaffected
  </success_criteria>

<output>
After completion, create `.planning/phases/08-rag-pipeline-improvements/08-02-SUMMARY.md`
</output>
