---
phase: 00-audit-baseline
plan: 01
type: execute
---

<objective>
Establish measurable baseline before any BizBot changes. Capture embedding eval scores, snapshot current feature/component state, and initialize project tracking.

Purpose: Every subsequent phase measures improvement against this baseline. Without it, we can't prove the overhaul worked.
Output: Eval results archived, STATE.md initialized, baseline metrics documented in summary.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/BOT-AUDIT-bizbot-2026-02-14.md

**Bot registry config (from /bot-audit shared registry):**
- DB table: `public.bizbot_documents`
- Content column: `content`
- Embedding column: `embedding`
- Webhooks: `/bizbot`, `/bizbot-licenses`, `/bizbot-license-finder`
- Accent color: orange
- Production file: `/root/vanderdev-website/src/pages/BizBot.jsx`

**Bot-eval scripts:** `~/.claude/commands/bot-eval/scripts/`
- `run-eval.py --core --bot bizbot --mode embedding` uses pre-built `assets/bizbot-core-suite.json` (35 queries)
- `generate-report.py` produces markdown report with gap analysis
- `log-history.py` appends to `~/.claude/data/bot-refresh-history.json`
- Embedding mode requires SSH to `vps` → `docker exec -i supabase-db psql`

**No prior phases.** This is the first phase — no decisions, issues, or summaries to inherit.
</context>

<tasks>

<task type="auto">
  <name>Task 1: Run embedding eval baseline with core suite</name>
  <files>.planning/phases/00-audit-baseline/bizbot-baseline-eval.json, .planning/phases/00-audit-baseline/bizbot-baseline-report.md</files>
  <action>
Run the bot-eval embedding pipeline against BizBot's knowledge base using the pre-built core suite.

1. Run eval:
```bash
cd ~/.claude/commands/bot-eval
python3 scripts/run-eval.py \
  --core --bot bizbot --mode embedding \
  --output /tmp/bizbot-baseline-eval.json --archive
```

2. Generate report (no baseline comparison — this IS the baseline):
```bash
python3 scripts/generate-report.py \
  --results /tmp/bizbot-baseline-eval.json \
  --output /tmp/bizbot-baseline-report.md
```

3. Log to history:
```bash
python3 scripts/log-history.py \
  --results /tmp/bizbot-baseline-eval.json --bot bizbot \
  --notes "Phase 0 baseline — pre-overhaul snapshot"
```

4. Copy results into planning directory:
```bash
cp /tmp/bizbot-baseline-eval.json .planning/phases/00-audit-baseline/bizbot-baseline-eval.json
cp /tmp/bizbot-baseline-report.md .planning/phases/00-audit-baseline/bizbot-baseline-report.md
```

If SSH to VPS fails, check that `ssh vps` works and that supabase-db container is running (`ssh vps "docker ps | grep supabase-db"`). Do NOT skip the eval — it's the entire point of this phase.
  </action>
  <verify>
- `bizbot-baseline-eval.json` exists and contains 35 query results
- `bizbot-baseline-report.md` exists and contains score summary
- `~/.claude/data/eval-history/` contains timestamped archive copy
- `~/.claude/data/bot-refresh-history.json` has new entry for bizbot
  </verify>
  <done>35-query embedding eval complete, report generated, results archived and logged to history</done>
</task>

<task type="auto">
  <name>Task 2: Snapshot current BizBot state</name>
  <files>.planning/phases/00-audit-baseline/CURRENT-STATE.md</files>
  <action>
SSH to VPS and inspect the production BizBot to document its current feature set. Create a snapshot file.

1. Read the production BizBot page:
```bash
ssh vps "cat /root/vanderdev-website/src/pages/BizBot.jsx"
```

2. Check what components BizBot currently imports (look for ChatMessage, getMarkdownComponents, react-markdown, DecisionTreeView, WizardStepper, etc.)

3. Check current mode switching logic (Chat, License Expert, License Finder modes)

4. Create `.planning/phases/00-audit-baseline/CURRENT-STATE.md` documenting:

```markdown
# BizBot Current State Snapshot
**Date:** 2026-02-14

## Modes
- [ ] Chat (general Q&A)
- [ ] License Expert (RAG-enhanced)
- [ ] License Finder (structured input)

## Component Usage
| Component | Imported? | Used? |
|-----------|-----------|-------|
| ChatMessage | ? | ? |
| getMarkdownComponents | ? | ? |
| react-markdown | ? | ? |
| remark-gfm | ? | ? |
| DecisionTreeView | ? | ? |
| WizardStepper | ? | ? |

## Rendering Pipeline
[How bot responses currently render — plain text? split on \n? markdown?]

## Webhook Endpoints
| Endpoint | Status | Response Shape |
|----------|--------|----------------|
| /bizbot | ? | ? |
| /bizbot-licenses | ? | ? |
| /bizbot-license-finder | ? | ? |

## Lines of Code
BizBot.jsx: [N] lines
```

Fill in all `?` marks with actual values from the production code. This is a factual snapshot, not aspirational.
  </action>
  <verify>
- CURRENT-STATE.md exists and contains no `?` placeholders
- All 3 modes documented with yes/no
- All 6 components documented with import status
- Rendering pipeline described
  </verify>
  <done>Production BizBot state fully documented with component inventory, mode list, and rendering pipeline</done>
</task>

<task type="auto">
  <name>Task 3: Initialize STATE.md with baseline metrics</name>
  <files>.planning/STATE.md</files>
  <action>
Create `.planning/STATE.md` to track project state across phases. Populate with Phase 0 baseline data.

```markdown
# BizBot Overhaul — Project State

## Current Position
Phase 0: Audit & Baseline — COMPLETE

## Baseline Metrics (2026-02-14)

### Audit Scores
| Category | Score |
|----------|-------|
| Database Health | 100/100 |
| URL Validation | 60/100 |
| Webhook Health | 70/100 (90 adjusted) |
| Knowledge Freshness | 100/100 |
| UI Parity | 42/100 |
| **Overall** | **74/100** |

### Eval Scores
| Metric | Value |
|--------|-------|
| Embedding eval (core suite) | [score from Task 1] |
| Queries tested | 35 |
| Coverage gaps | [from report] |

### Feature State
[Pull from Task 2 CURRENT-STATE.md]

## Accumulated Decisions
- Production-first: All code on VPS via SSH
- Phase 2 (Shared Infra) skipped: WaterBot patterns exist
- License Finder 400 is false positive: audit test needs `industry` field

## Deferred Issues
- ftb.ca.gov 403s (14 URLs): Bot-blocking WAF, not truly broken
- bizfileonline.sos.ca.gov 403s (3 URLs): Same — bot-blocking
- Metadata enrichment (~60% basic blobs): Low priority, deferred past overhaul

## Blockers
None
```

Fill in `[score from Task 1]`, `[from report]`, and `[Pull from Task 2]` with actual data from the previous tasks. Do NOT leave placeholders.
  </action>
  <verify>
- STATE.md exists at `.planning/STATE.md`
- Contains actual eval scores (not placeholders)
- Contains feature state from CURRENT-STATE.md
- Accumulated decisions match PROJECT.md
  </verify>
  <done>STATE.md initialized with baseline audit + eval metrics, feature snapshot, decisions, deferred issues — ready for Phase 1</done>
</task>

</tasks>

<verification>
Before declaring phase complete:
- [ ] Eval results exist at `.planning/phases/00-audit-baseline/bizbot-baseline-eval.json`
- [ ] Eval report exists at `.planning/phases/00-audit-baseline/bizbot-baseline-report.md`
- [ ] Current state snapshot exists at `.planning/phases/00-audit-baseline/CURRENT-STATE.md`
- [ ] STATE.md exists at `.planning/STATE.md` with no placeholders
- [ ] Eval history logged to `~/.claude/data/bot-refresh-history.json`
- [ ] All files committed to git
</verification>

<success_criteria>

- Embedding eval baseline captured (35 queries scored)
- Eval results archived for future `--baseline auto` comparison
- Production BizBot component/feature state documented
- STATE.md initialized with all baseline metrics
- No placeholders or `?` marks in any output file
- Phase 0 complete, ready for Phase 1 planning
</success_criteria>

<output>
After completion, create `.planning/phases/00-audit-baseline/00-01-SUMMARY.md`:

# Phase 0 Plan 1: Audit & Baseline Summary

**[One-liner: e.g., "BizBot baseline captured at 74/100 audit, X% embedding coverage — ready for overhaul"]**

## Accomplishments

- Embedding eval baseline: [score] across 35 queries
- [N] coverage gaps identified in eval report
- Production state snapshot: [modes], [components present/missing]
- STATE.md initialized with all metrics

## Files Created/Modified

- `.planning/phases/00-audit-baseline/bizbot-baseline-eval.json` — Raw eval results
- `.planning/phases/00-audit-baseline/bizbot-baseline-report.md` — Eval report
- `.planning/phases/00-audit-baseline/CURRENT-STATE.md` — Production state snapshot
- `.planning/STATE.md` — Project state tracker

## Decisions Made

None (Phase 0 is observation-only)

## Issues Encountered

[Any SSH issues, eval failures, or unexpected findings]

## Next Step

Phase 0 complete. Ready for `/gsd:plan-phase 01-knowledge-refresh`.
</output>
