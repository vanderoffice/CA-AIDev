---
phase: 01-knowledge-refresh
plan: 01
type: execute
---

<objective>
Research correct replacement URLs for 6 dead/broken links and remediate all URL issues in BizBot knowledge base source files.

Purpose: Fix URL health from 60% to 95%+ by correcting dead links, updating redirects to canonical destinations, and documenting bot-blocking false positives.
Output: Corrected markdown source files ready for re-ingestion.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/00-audit-baseline/00-01-SUMMARY.md
@.planning/BOT-AUDIT-bizbot-2026-02-14.md

# Key source files with dead URLs (from discovery):
@BizAssessment/04_Industry_Requirements/Construction/CSLB_Licensing_Guide.md
@BizAssessment/04_Industry_Requirements/Retail/General_Retail_Guide.md
@BizAssessment/04_Industry_Requirements/Cannabis/Cannabis_Licensing_Guide.md
@BizAssessment/CA_DCA_Comprehensive_URL_Guide.md
@BizAssessment/url_fixes_2025-12-31.md
@BizAssessment/url_validator.py
@BizAssessment/create_url_database.py

# Prior URL remediation history:
@BizAssessment/url_fixes_2025-12-31.md

**Constraining decisions:**
- Phase 0: Both WEAK eval scores are intentionally off-domain — not knowledge gaps
- Production-first doctrine applies to CODE only — knowledge content is ingested from dev repo via `/bot-ingest`
- Knowledge source files live at `~/Documents/GitHub/CA-AIDev/bizbot/BizAssessment/`

**Dead URLs requiring replacement (from audit):**
1. `www.cslb.ca.gov/About_Us/Library/Licensing_Timeframes.aspx` → redirects to Page_Not_Found (in CSLB_Licensing_Guide.md lines 354, 603)
2. `www.cslb.ca.gov/Licensees/Renew_A_License.aspx` → redirects to Page_Not_Found (in CA_DCA_Comprehensive_URL_Guide.md line 28)
3. `www.cslb.ca.gov/fees.aspx` → redirects to Page_Not_Found (referenced in audit, may be in DB chunks only)
4. `www.dgs.ca.gov/DSA/Resources/CASp-Program` → redirects to 404 (in General_Retail_Guide.md line 340)
5. `onlineservices.cdtfa.ca.gov` → genuinely dead 404 (in url_validator.py, create_url_database.py — tool files only, may not be in ingested content)
6. `ca.metrc.com` → domain changed (in Cannabis_Licensing_Guide.md lines 347, 568)

**Redirect URLs (44 total):** URLs that work but redirect — update to canonical final destinations.

**Bot-blocking false positives (17 total):** ftb.ca.gov (14), bizfileonline.sos.ca.gov (3) — document, don't fix.
</context>

<tasks>

<task type="auto">
  <name>Task 1: Research replacement URLs and fix dead links in source files</name>
  <files>BizAssessment/04_Industry_Requirements/Construction/CSLB_Licensing_Guide.md, BizAssessment/04_Industry_Requirements/Retail/General_Retail_Guide.md, BizAssessment/04_Industry_Requirements/Cannabis/Cannabis_Licensing_Guide.md, BizAssessment/CA_DCA_Comprehensive_URL_Guide.md, BizAssessment/url_validator.py, BizAssessment/create_url_database.py</files>
  <action>
Research current URLs for each dead link using web search:

1. **CSLB Licensing Timeframes** — CSLB migrated off `.aspx` paths. Search for current CSLB processing times / licensing timeframes page. Replace `www.cslb.ca.gov/About_Us/Library/Licensing_Timeframes.aspx` in CSLB_Licensing_Guide.md (lines 354 and 603).

2. **CSLB Renew A License** — Search for current CSLB license renewal page. Replace `www.cslb.ca.gov/Licensees/Renew_A_License.aspx` in CA_DCA_Comprehensive_URL_Guide.md (line 28). Also grep all `.md` files for any other occurrences of this URL.

3. **CSLB Fees** — Search for current CSLB fee schedule page. Replace `www.cslb.ca.gov/fees.aspx` if found in any source file (may only exist in DB chunks from prior ingestion — grep to confirm).

4. **DGS CASp Program** — Search for current DGS Certified Access Specialist program page. Replace `www.dgs.ca.gov/DSA/Resources/CASp-Program` in General_Retail_Guide.md (line 340).

5. **CDTFA Online Services** — The `onlineservices.cdtfa.ca.gov` subdomain is dead. Search for current CDTFA online services portal. Fix references in url_validator.py (line 66) and create_url_database.py (line 79). These are tool files — check if this URL also appears in any `.md` content files.

6. **Metrc California** — The cannabis track-and-trace system moved from `ca.metrc.com`. Search for current Metrc California domain. Replace in Cannabis_Licensing_Guide.md (lines 347 and 568).

For each URL: use `WebSearch` to find the current page, then `curl -sI` the candidate URL to verify it returns 200. Only update source files with verified-working URLs. If no replacement found, add a comment noting the URL is dead and remove it from link text (convert to plain text reference).

Do NOT modify any content beyond URL strings — preserve all surrounding text, formatting, and metadata.
  </action>
  <verify>
For each replaced URL, run: `curl -sI -o /dev/null -w "%{http_code}" [NEW_URL]` — must return 200 or 301 (to a working page).
Grep the entire BizAssessment/ directory for any remaining occurrences of the 6 old URL patterns to confirm none were missed.
  </verify>
  <done>All 6 dead URLs either replaced with verified-working alternatives or documented as removed. Zero dead-redirect URLs remain in source markdown files.</done>
</task>

<task type="auto">
  <name>Task 2: Update redirect URLs to canonical destinations and document false positives</name>
  <files>BizAssessment/*.md, BizAssessment/**/*.md, BizAssessment/url_fixes_2025-12-31.md</files>
  <action>
**Part A: Update redirect URLs**

Run the existing url_validator.py to get fresh redirect data:
```bash
cd ~/Documents/GitHub/CA-AIDev/bizbot/BizAssessment && python url_validator.py
```

If url_validator.py is not runnable standalone, manually check the highest-impact redirects from the audit. Focus on redirects where:
- The redirect chain is 2+ hops (wastes time)
- The redirect target has a significantly different path (indicates a site restructuring)
- The domain changed (e.g., `http://` → `https://`, or subdomain change)

For each redirect: replace the old URL with the final destination URL in the source `.md` file. Use `grep -rn "OLD_URL" BizAssessment/` to find all occurrences before replacing.

Skip redirects that are just HTTP→HTTPS upgrades on the same path (browsers handle these fine).
Skip redirects where the final URL is on a different domain (may indicate a site migration that could change again).

**Part B: Document bot-blocking false positives**

Append a new section to `BizAssessment/url_fixes_2025-12-31.md` documenting the 2026-02-14 audit findings:

```markdown
## Bot-Blocking False Positives (2026-02-14 Audit)

These URLs return 403 to automated validation but work in browsers:

| Domain | Count | Notes |
|--------|-------|-------|
| ftb.ca.gov | 14 | Franchise Tax Board WAF blocks bots |
| bizfileonline.sos.ca.gov | 3 | Secretary of State filing portal |
| cslb.ca.gov/resources | 1 | Specific path blocked |
| dtsc.ca.gov | 1 | Trailing slash variant |
| planning.lacity.gov | 1 | LA City Planning |
| nsf.org | 1 | National Sanitation Foundation |

**Action:** No fix needed. URLs functional for users. Exclude from automated health scoring.
```

Also add entries for any timeout URLs (sandiegocounty.gov, sdapcd.org, valleyair.org) and the cdph.ca.gov connection errors.
  </action>
  <verify>
Count remaining redirects by running a spot-check: `curl -sI -o /dev/null -w "%{http_code}" [SAMPLE_OF_5_UPDATED_URLS]` — should return 200 (not 301/302).
Confirm url_fixes_2025-12-31.md has the new bot-blocking documentation section.
  </verify>
  <done>Redirect URLs updated to canonical destinations in source files. Bot-blocking false positives documented with counts and rationale. url_fixes log updated with 2026-02-14 remediation notes.</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] All 6 dead URLs fixed or documented as removed
- [ ] Redirect URLs updated to canonical destinations (spot-check 5+ URLs return 200)
- [ ] No remaining references to old dead URL patterns in source `.md` files
- [ ] url_fixes_2025-12-31.md updated with 2026-02-14 remediation log
- [ ] Bot-blocking false positives documented
- [ ] All changes are in BizAssessment/ source files only — no database or production changes yet
</verification>

<success_criteria>

- All 6 dead/broken URLs replaced with verified-working alternatives
- Redirect URLs updated to canonical final destinations
- Bot-blocking false positives documented
- Source files ready for re-ingestion in Plan 02
- url_fixes log updated
</success_criteria>

<output>
After completion, create `.planning/phases/01-knowledge-refresh/01-01-SUMMARY.md`
</output>
